(function(){function a(){this.options={url:"http://ws.audioscrobbler.com/2.0/?method=user.getrecenttracks",apiKey:"",username:"",container:"lfm-container",musicClass:"lfm-music",artistClass:"lfm-artist",imageClass:"lfm-image",trackClass:"lfm-track",imageSize:"large",autoUpdate:false,interval:30000,noImage:"img/cover_placeholder_lg.jpg",limit:6};
this.tracksList=[];}a.prototype.init=function(c){var b=this,d;b.options=b.extend(b.options,c);d=b.options;d.url+="&user="+d.username+"&api_key="+d.apiKey+"&format=json&limit="+d.limit;
this.update();};a.prototype.extend=function(e,b){var d={};for(var c in e){if(typeof b[c]!=="undefined"){d[c]=b[c];}else{d[c]=e[c];}}return d;};a.prototype.update=function(){var b=this,c=b.options;
b.request();if(c.autoUpdate){setInterval(function(){b.request();},c.interval);}};a.prototype.request=function(){var c=this,e=c.options,d,b=0;this.ajax(e.url,function(f){c.tracksList=f.recenttracks.track;
c.emptyElement(e.container);for(d=0,length=c.tracksList.length;d<length;d+=1){if(b<e.limit){c.elementMaker(c.tracksList[d]);b+=1;}}});};a.prototype.getElement=function(c){var b;
if(document.querySelectorAll("."+c).length>0){b=document.querySelectorAll("."+c);}else{if(document.querySelectorAll("#"+c).length>0){b=document.querySelectorAll("#"+c);
}}b=b[0];return b;};a.prototype.emptyElement=function(d){var b=this.getElement(d);while(b.hasChildNodes()){b.removeChild(b.firstChild);}};a.prototype.verifyCover=function(e){var b=e.split("."),d=b.length-1,c=this.options;
if(b[d].length===0){b=c.noImage;}else{b=e;}return b;};a.prototype.elementMaker=function(h,f){var m=this,e=m.options,c=m.getElement(e.container),i=document.createElement("div"),j=document.createElement("span"),g=document.createElement("span"),k=document.createElement("img"),l=document.createTextNode(h.artist["#text"]),b=document.createTextNode(h.name),d=m.setImageIndex(e.imageSize);
if(h["@attr"]){i.className=e.trackClass+" now-playing";}else{i.className=e.trackClass;}k.src=m.verifyCover(h.image[d]["#text"]);k.className=e.imageClass;
g.className=e.musicClass;j.className=e.artistClass;j.appendChild(l);g.appendChild(b);i.appendChild(k);i.appendChild(j);i.appendChild(g);c.appendChild(i);
};a.prototype.setImageIndex=function(c){var b=2;switch(c){case"small":b=0;break;case"meddium":b=1;break;case"large":b=2;break;case"extralarge":b=3;break;
}return b;};a.prototype.ajax=function(c,f){var e,d=function(g){if(window.XMLHttpRequest){e=new XMLHttpRequest();}else{if(window.ActiveXObject){try{e=new ActiveXObject("Msxml2.XMLHTTP");
}catch(h){try{e=new ActiveXObject("Microsoft.XMLHTTP");}catch(h){}}}}e.onreadystatechange=b;e.open("GET",g,true);e.send(null);},b=function(){if(e.readyState===4){if(e.status===200){var g=e.responseText;
g=JSON.parse(g);f(g);}}};d(c);};window.LastFM=new a();})();